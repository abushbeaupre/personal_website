<script>
// Language toggle functionality
document.addEventListener('DOMContentLoaded', function() {
  let currentLang = localStorage.getItem('language') || 'en';
  setLanguage(currentLang);
  
  document.querySelectorAll('.lang-toggle-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const lang = this.dataset.lang;
      setLanguage(lang);
      localStorage.setItem('language', lang);
    });
  });
});

function setLanguage(lang) {
  // Hide all language content
  document.querySelectorAll('.lang-en, .lang-fr').forEach(el => {
    el.style.display = 'none';
  });
  
  // Show selected language content
  document.querySelectorAll('.lang-' + lang).forEach(el => {
    el.style.display = 'block';
  });
  
  // Update active button state
  document.querySelectorAll('.lang-toggle-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.lang === lang) {
      btn.classList.add('active');
    }
  });
  
  // Update table of contents
  updateTOC(lang);
}

function updateTOC(lang) {
  // Get all TOC links
  const tocLinks = document.querySelectorAll('#TOC nav ul li a');
  
  tocLinks.forEach(link => {
    const li = link.parentElement;
    const targetId = link.getAttribute('href')?.substring(1);
    
    if (targetId) {
      const targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        // Check if target element has a language class
        const hasLangClass = targetElement.classList.contains('lang-en') || 
                            targetElement.classList.contains('lang-fr');
        
        if (hasLangClass) {
          // Show/hide based on current language
          if (targetElement.classList.contains('lang-' + lang)) {
            li.style.display = '';
          } else {
            li.style.display = 'none';
          }
        }
      }
    }
  });
}
</script>
