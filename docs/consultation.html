<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Consultation ‚Äì Allen Bush-Beaupr√©</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Allen Bush-Beaupr√©</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./consultation.html" aria-current="page"> 
<span class="menu-text">Statistical Consultation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./posts.html"> 
<span class="menu-text">My Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#book-a-consultation" id="toc-book-a-consultation" class="nav-link active" data-scroll-target="#book-a-consultation">Book a Consultation</a>
  <ul class="collapse">
  <li><a href="#what-i-can-help-with" id="toc-what-i-can-help-with" class="nav-link" data-scroll-target="#what-i-can-help-with">What I Can Help With</a></li>
  <li><a href="#before-your-consultation" id="toc-before-your-consultation" class="nav-link" data-scroll-target="#before-your-consultation">Before Your Consultation</a></li>
  </ul></li>
  <li><a href="#r√©server-une-consultation" id="toc-r√©server-une-consultation" class="nav-link" data-scroll-target="#r√©server-une-consultation">R√©server une consultation</a>
  <ul class="collapse">
  <li><a href="#comment-je-peux-aider" id="toc-comment-je-peux-aider" class="nav-link" data-scroll-target="#comment-je-peux-aider">Comment je peux aider</a></li>
  <li><a href="#avant-votre-consultation" id="toc-avant-votre-consultation" class="nav-link" data-scroll-target="#avant-votre-consultation">Avant votre consultation</a></li>
  </ul></li>
  <li><a href="#schedule-your-meeting" id="toc-schedule-your-meeting" class="nav-link" data-scroll-target="#schedule-your-meeting">Schedule Your Meeting</a></li>
  <li><a href="#planifier-votre-rencontre" id="toc-planifier-votre-rencontre" class="nav-link" data-scroll-target="#planifier-votre-rencontre">Planifier votre rencontre</a></li>
  <li><a href="#share-your-files" id="toc-share-your-files" class="nav-link" data-scroll-target="#share-your-files">Share Your Files</a></li>
  <li><a href="#partager-vos-fichiers" id="toc-partager-vos-fichiers" class="nav-link" data-scroll-target="#partager-vos-fichiers">Partager vos fichiers</a></li>
  <li><a href="#alternative-contact" id="toc-alternative-contact" class="nav-link" data-scroll-target="#alternative-contact">Alternative Contact</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Consultation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="language-toggle-container">
<p><button class="lang-btn active" data-lang="en">English</button> <button class="lang-btn" data-lang="fr">Fran√ßais</button></p>
</div>
<section id="book-a-consultation" class="level2 lang-en">
<h2 class="anchored" data-anchor-id="book-a-consultation">Book a Consultation</h2>
<p>I provide statistical consulting services for graduate students and researchers in the Ecology department. Whether you need help with study design, data analysis, or interpreting results, I‚Äôm here to assist.</p>
<section id="what-i-can-help-with" class="level3">
<h3 class="anchored" data-anchor-id="what-i-can-help-with">What I Can Help With</h3>
<ul>
<li><strong>Study Design</strong>: Power analysis, sampling strategies, experimental design</li>
<li><strong>Data Analysis</strong>: GLM/GLMM, path analysis, multivariate statistics, Bayesian methods</li>
<li><strong>R Programming</strong>: Data wrangling, visualization, reproducible workflows</li>
<li><strong>Results Interpretation</strong>: Understanding model outputs, effect sizes, diagnostics</li>
</ul>
</section>
<section id="before-your-consultation" class="level3">
<h3 class="anchored" data-anchor-id="before-your-consultation">Before Your Consultation</h3>
<p>Please prepare:</p>
<ul>
<li>A brief description of your research question</li>
<li>Information about your data (sample size, variables, study design)</li>
<li>Specific questions or challenges you‚Äôre facing</li>
<li>Any relevant code or output (if applicable)</li>
</ul>
</section>
</section>
<section id="r√©server-une-consultation" class="level2 lang-fr">
<h2 class="anchored" data-anchor-id="r√©server-une-consultation">R√©server une consultation</h2>
<p>J‚Äôoffre des services de consultation statistique aux √©tudiants dipl√¥m√©s et aux chercheurs du d√©partement d‚Äô√âcologie. Que vous ayez besoin d‚Äôaide pour la conception d‚Äô√©tude, l‚Äôanalyse de donn√©es ou l‚Äôinterpr√©tation des r√©sultats, je suis l√† pour vous aider.</p>
<section id="comment-je-peux-aider" class="level3">
<h3 class="anchored" data-anchor-id="comment-je-peux-aider">Comment je peux aider</h3>
<ul>
<li><strong>Conception d‚Äô√©tude</strong>: Analyse de puissance, strat√©gies d‚Äô√©chantillonnage, plan exp√©rimental</li>
<li><strong>Analyse de donn√©es</strong>: GLM/GLMM, analyse de cheminement, statistiques multivari√©es, m√©thodes bay√©siennes</li>
<li><strong>Programmation R</strong>: Manipulation de donn√©es, visualisation, flux de travail reproductibles</li>
<li><strong>Interpr√©tation des r√©sultats</strong>: Comprendre les sorties de mod√®le, tailles d‚Äôeffet, diagnostics</li>
</ul>
</section>
<section id="avant-votre-consultation" class="level3">
<h3 class="anchored" data-anchor-id="avant-votre-consultation">Avant votre consultation</h3>
<p>Veuillez pr√©parer:</p>
<ul>
<li>Une br√®ve description de votre question de recherche</li>
<li>Informations sur vos donn√©es (taille d‚Äô√©chantillon, variables, plan d‚Äô√©tude)</li>
<li>Questions sp√©cifiques ou d√©fis auxquels vous faites face</li>
<li>Tout code ou sortie pertinent (le cas √©ch√©ant)</li>
</ul>
</section>
</section>
<hr>
<section id="schedule-your-meeting" class="level2 lang-en">
<h2 class="anchored" data-anchor-id="schedule-your-meeting">Schedule Your Meeting</h2>
<p>Click the button below to open the booking calendar in a new window. You‚Äôll be able to answer a few questions about your needs and schedule a time that works for you. The intake questions will help me prepare for our meeting.</p>
</section>
<section id="planifier-votre-rencontre" class="level2 lang-fr">
<h2 class="anchored" data-anchor-id="planifier-votre-rencontre">Planifier votre rencontre</h2>
<p>Cliquez sur le bouton ci-dessous pour ouvrir le calendrier de r√©servation dans une nouvelle fen√™tre. Vous pourrez r√©pondre √† quelques questions sur vos besoins et planifier un moment qui vous convient. Les questions d‚Äôadmission m‚Äôaideront √† pr√©parer notre rencontre.</p>
</section>
<div style="text-align: center; padding: 3rem; background-color: #f8f9fa; border-radius: 8px; margin: 2rem 0;">
<p><a href="https://outlook.office.com/book/Consultationsstatistiquesrencontreinitiale@USherbrooke.onmicrosoft.com/" target="_blank" rel="noopener noreferrer" style="display: inline-block; padding: 15px 40px; background-color: #0078d4; color: white; text-decoration: none; border-radius: 6px; font-weight: bold; font-size: 1.2em; box-shadow: 0 2px 8px rgba(0,120,212,0.3);"><span class="lang-en">üìÖ Book Your Consultation</span><span class="lang-fr">üìÖ R√©server votre consultation</span></a></p>
<p style="margin-top: 1.5rem; color: #666; font-size: 0.9em; font-style: italic;" class="lang-en">
</p><p>The booking page will open in a new window</p>
<p></p>
<p style="margin-top: 1.5rem; color: #666; font-size: 0.9em; font-style: italic;" class="lang-fr">
</p><p>La page de r√©servation s‚Äôouvrira dans une nouvelle fen√™tre</p>
<p></p>
</div>
<hr>
<section id="share-your-files" class="level2 lang-en">
<h2 class="anchored" data-anchor-id="share-your-files">Share Your Files</h2>
<p>If you have data files, code, or documents you‚Äôd like me to review before our meeting, you can upload them securely using the button below. Files will be saved directly to my Dropbox.</p>
<p><strong>What to share:</strong></p>
<ul>
<li>Data files (.csv, .xlsx, .txt, .rds, etc.)</li>
<li>R scripts or analysis code</li>
<li>Output files or error messages</li>
<li>Research proposals or study designs</li>
<li>Any other relevant documents</li>
</ul>
</section>
<section id="partager-vos-fichiers" class="level2 lang-fr">
<h2 class="anchored" data-anchor-id="partager-vos-fichiers">Partager vos fichiers</h2>
<p>Si vous avez des fichiers de donn√©es, du code ou des documents que vous aimeriez que je r√©vise avant notre rencontre, vous pouvez les t√©l√©charger en toute s√©curit√© en utilisant le bouton ci-dessous. Les fichiers seront sauvegard√©s directement dans mon Dropbox.</p>
<p><strong>Quoi partager:</strong></p>
<ul>
<li>Fichiers de donn√©es (.csv, .xlsx, .txt, .rds, etc.)</li>
<li>Scripts R ou code d‚Äôanalyse</li>
<li>Fichiers de sortie ou messages d‚Äôerreur</li>
<li>Propositions de recherche ou plans d‚Äô√©tude</li>
<li>Tout autre document pertinent</li>
</ul>
</section>
<div style="text-align: center; padding: 3rem; background-color: #e8f4f8; border-radius: 8px; margin: 2rem 0;">
<p><a href="https://www.dropbox.com/request/qyN8JJ6VWFYd64E9fbTd" target="_blank" rel="noopener noreferrer" style="display: inline-block; padding: 15px 40px; background-color: #0061ff; color: white; text-decoration: none; border-radius: 6px; font-weight: bold; font-size: 1.2em; box-shadow: 0 2px 8px rgba(0,97,255,0.3);"><span class="lang-en">üì§ Upload Files to Dropbox</span><span class="lang-fr">üì§ T√©l√©charger des fichiers sur Dropbox</span></a></p>
<p style="margin-top: 1.5rem; color: #666; font-size: 0.9em; font-style: italic;" class="lang-en">
</p><p>No Dropbox account required ‚Ä¢ Files are uploaded securely</p>
<p></p>
<p style="margin-top: 1.5rem; color: #666; font-size: 0.9em; font-style: italic;" class="lang-fr">
</p><p>Aucun compte Dropbox requis ‚Ä¢ Les fichiers sont t√©l√©charg√©s en toute s√©curit√©</p>
<p></p>
</div>
<hr>
<section id="alternative-contact" class="level3">
<h3 class="anchored" data-anchor-id="alternative-contact">Alternative Contact</h3>
<p>If you prefer to email me directly to discuss your needs before scheduling, you can reach me at allen.bush-beaupre@usherbrooke.ca</p>


</section>

</main> <!-- /main -->
<script>
// Language toggle functionality
document.addEventListener('DOMContentLoaded', function() {
  // Get saved language preference or default to English
  let currentLang = localStorage.getItem('language') || 'en';
  
  // Apply language on page load
  setLanguage(currentLang);
  
  // Add click handlers to language buttons
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const lang = this.dataset.lang;
      setLanguage(lang);
      localStorage.setItem('language', lang);
    });
  });
});

function setLanguage(lang) {
  // Hide all language content
  document.querySelectorAll('[class*="lang-"]').forEach(el => {
    el.style.display = 'none';
  });
  
  // Show selected language content
  document.querySelectorAll('.lang-' + lang).forEach(el => {
    el.style.display = 'block';
  });
  
  // Update active button state
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  document.querySelectorAll('[data-lang="' + lang + '"]').forEach(btn => {
    btn.classList.add('active');
  });
}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>